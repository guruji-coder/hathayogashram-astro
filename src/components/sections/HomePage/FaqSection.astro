---
import { FAQ_SECTION, FAQ_STYLES } from "../../../constants/faqConstants";
---

<!-- FAQ Section - SEO Optimized -->
<section class={`${FAQ_STYLES.SECTION_PADDING} bg-gradient-to-b from-purple-50 to-white`}>
	<div class={FAQ_STYLES.CONTAINER}>
		<!-- Section Header -->
		<div class="mb-16 text-center">
			<h2 class={FAQ_STYLES.TITLE}>
				{FAQ_SECTION.TITLE}
			</h2>

			<!-- Decorative Underline SVG -->
			<div class="mb-6 flex justify-center">
				<svg width="200" height="20" viewBox="0 0 200 20" class="text-purple-900">
					<path d="M10 10 Q 100 5 190 10" stroke="currentColor" stroke-width="2" fill="none" />
					<circle cx="100" cy="8" r="8" fill="currentColor" />
					<path d="M92 8 L96 12 L104 4 L108 8" fill="white" stroke="none" />
				</svg>
			</div>
		</div>

		<!-- FAQ Items - Static HTML for SEO -->
		<div class="mx-auto max-w-4xl space-y-4" itemscope itemtype="https://schema.org/FAQPage">
			{FAQ_SECTION.FAQS.map((faq, index) => (
				<div 
					class={FAQ_STYLES.FAQ_ITEM} 
					data-faq-item={index}
					itemscope 
					itemtype="https://schema.org/Question"
				>
					<!-- Question Button -->
					<button
						class={`${FAQ_STYLES.QUESTION_BUTTON} ${FAQ_STYLES.QUESTION_BUTTON_INACTIVE} flex cursor-pointer justify-between faq-toggle`}
						data-faq-toggle={index}
						aria-expanded="false"
						aria-controls={`faq-answer-${index}`}
						itemprop="name"
					>
						<div class="flex items-center">
							<!-- Question Icon -->
							<div class={`${FAQ_STYLES.QUESTION_ICON} text-purple-900`}>
								<i class="fas fa-question"></i>
							</div>

							<!-- Question Text -->
							<span class={FAQ_STYLES.QUESTION_TEXT}>
								{faq.question}
							</span>
						</div>

						<!-- Toggle Icon -->
						<div class={`${FAQ_STYLES.TOGGLE_ICON} text-purple-900`}>
							<i class="fas fa-plus faq-icon"></i>
						</div>
					</button>

					<!-- Answer - Always in DOM for SEO -->
					<div
						id={`faq-answer-${index}`}
						class={`${FAQ_STYLES.ANSWER_CONTAINER} faq-answer`}
						style="display: none;"
						itemscope
						itemtype="https://schema.org/Answer"
					>
						<div class={FAQ_STYLES.ANSWER_TEXT} itemprop="text">
							{faq.answer}
						</div>
					</div>
				</div>
			))}
		</div>

		<!-- Contact CTA -->
		<div class="mt-16 text-center">
			<p class="mb-6 text-lg text-gray-700">
				{FAQ_SECTION.CTA.SUBTITLE}
			</p>
			<a href={FAQ_SECTION.CTA.LINK} class={FAQ_STYLES.CTA_BUTTON}>
				{FAQ_SECTION.CTA.BUTTON_TEXT}
			</a>
		</div>
	</div>
</section>

<!-- Progressive Enhancement Script -->
<script>
	document.addEventListener('DOMContentLoaded', function() {
		const toggleButtons = document.querySelectorAll('[data-faq-toggle]');
		
		toggleButtons.forEach(function(button) {
			button.addEventListener('click', function() {
				const index = button.getAttribute('data-faq-toggle');
				const answer = document.getElementById(`faq-answer-${index}`);
				const icon = button.querySelector('.faq-icon');
				
				if (!answer || !icon) return;
				
				const isOpen = answer.style.display !== 'none';
				
				// Close all other FAQs
				document.querySelectorAll('.faq-answer').forEach(function(otherAnswer) {
					if (otherAnswer !== answer) {
						otherAnswer.style.display = 'none';
					}
				});
				
				document.querySelectorAll('[data-faq-toggle]').forEach(function(otherButton) {
					if (otherButton !== button) {
						otherButton.setAttribute('aria-expanded', 'false');
						otherButton.className = otherButton.className.replace('bg-gradient-to-r from-purple-600 to-orange-500 text-white', 'bg-white text-purple-900 border-purple-200 hover:border-purple-300');
						
						const otherIcon = otherButton.querySelector('.faq-icon');
						const otherQuestionIcon = otherButton.querySelector('.fas.fa-question')?.parentElement;
						const otherToggleIcon = otherIcon?.parentElement;
						
						if (otherIcon) {
							otherIcon.className = otherIcon.className.replace('fa-minus', 'fa-plus');
						}
						
						if (otherQuestionIcon) {
							otherQuestionIcon.className = otherQuestionIcon.className.replace('text-white', 'text-purple-900');
						}
						
						if (otherToggleIcon) {
							otherToggleIcon.className = otherToggleIcon.className.replace('text-white', 'text-purple-900');
						}
					}
				});
				
				// Toggle current FAQ
				if (isOpen) {
					// Close current FAQ
					answer.style.display = 'none';
					button.setAttribute('aria-expanded', 'false');
					button.className = button.className.replace('bg-gradient-to-r from-purple-600 to-orange-500 text-white', 'bg-white text-purple-900 border-purple-200 hover:border-purple-300');
					
					icon.className = icon.className.replace('fa-minus', 'fa-plus');
					
					const questionIcon = button.querySelector('.fas.fa-question')?.parentElement;
					const toggleIcon = icon.parentElement;
					
					if (questionIcon) {
						questionIcon.className = questionIcon.className.replace('text-white', 'text-purple-900');
					}
					if (toggleIcon) {
						toggleIcon.className = toggleIcon.className.replace('text-white', 'text-purple-900');
					}
				} else {
					// Open current FAQ
					answer.style.display = 'block';
					button.setAttribute('aria-expanded', 'true');
					button.className = button.className.replace('bg-white text-purple-900 border-purple-200 hover:border-purple-300', 'bg-gradient-to-r from-purple-600 to-orange-500 text-white');
					
					icon.className = icon.className.replace('fa-plus', 'fa-minus');
					
					const questionIcon = button.querySelector('.fas.fa-question')?.parentElement;
					const toggleIcon = icon.parentElement;
					
					if (questionIcon) {
						questionIcon.className = questionIcon.className.replace('text-purple-900', 'text-white');
					}
					if (toggleIcon) {
						toggleIcon.className = toggleIcon.className.replace('text-purple-900', 'text-white');
					}
				}
			});
		});
	});
</script>

<style>
	.faq-answer {
		transition: all 0.3s ease-in-out;
		overflow: hidden;
	}
	
	.faq-toggle {
		transition: all 0.2s ease;
	}
	
	.faq-toggle:hover {
		transform: translateY(-1px);
	}
</style>
